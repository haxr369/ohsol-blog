---
title: YSK 테스트 코드 적용
date: 2025-05-01
lastmod: 2025-05-01
tags: ['java', 'test', 'junit', 'assertj', 'mockito']
draft: true
summary: 'YSK 테스트 코드 적용'
---

## 목차

<TOCInline toc={props.toc} exclude="목차" toHeading={(2, 3)} />

## 목적

1. 테스트 코드는 코드의 안정성과 신뢰성을 높여 예상치 못한 오류를 사전에 방지할 수 있습니다.
2. 기능 추가나 수정 시 기존 로직의 정상 동작을 검증하여 사이드 이펙트를 줄일 수 있습니다.
3. 테스트를 작성하려면 컴포넌트의 역할이 명확해야 하므로 코드 구조가 자연스럽게 정리되고 불필요한 로직을 줄일 수 있습니다

## 요구사항

### 1. 환경 요구사항
- 외부 인터넷망 사용 불가
- Java 7 버전 호환성
- Java 8로의 마이그레이션 가능성 보장

### 2. 프레임워크 요구사항
- SpringBoot 등 WAS 프레임워크 독립적 구현
- 프레임워크 의존성 최소화

### 3. 테스트 작성 요구사항
- 단위 테스트는 메서드 단위로 작성
- 외부 컴포넌트 연계 시 모킹 라이브러리 사용
- 테스트 케이스의 독립성 보장

## 테스트 준비

### 1. JUnit 4
- 테스트 프레임워크로 JUnit 4 사용
- JUnit 모듈 구성
  - Jupiter: 테스트 어노테이션과 테스트 인터페이스 제공
  - Platform: 테스트 실행 환경 제공
  - Vintage: JUnit 3과 4 테스트 지원

### 2. Mockito 2.28.2 
- 모킹 라이브러리
- 외부 의존성을 가진 컴포넌트 테스트에 사용
- 메서드 호출 검증 및 동작 정의 가능

### 3. AssertJ Core 3.11.1
- 검증 라이브러리
- 가독성 높은 검증 구문 제공
- 체이닝 방식의 검증 메서드 지원

### Test 생애주기 관련 Annotation

- @Test: 테스트 메서드임을 나타냄
- @BeforeEach: 각 테스트 메서드 실행 전에 실행되는 메서드
- @AfterEach: 각 테스트 메서드 실행 후에 실행되는 메서드
- @BeforeAll: 모든 테스트 메서드 실행 전에 실행되는 메서드 (static)
- @AfterAll: 모든 테스트 메서드 실행 후에 실행되는 메서드 (static)

### F.I.R.S.T 원칙

- Fast: 테스트는 빠르게 실행되어야 함
- Independent: 테스트는 서로 독립적이어야 함
- Repeatable: 테스트는 반복 가능해야 함
- Self-validating: 테스트는 스스로 검증되어야 함
- Timely: 테스트는 적시에 작성되어야 함








## 테스트 코드 작성 방법

### 1. 테스트 명명 규칙

1. 테스트 클래스 명명 규칙
   - 테스트 대상 클래스명 + Test
   - 예: `UserService` → `UserServiceTest`

2. 테스트 메서드 명명 규칙
   - `@Test` 메서드는 테스트하고자 하는 기능을 명확하게 표현
   - given_when_then 패턴 사용
   - 예: `givenValidUser_whenLogin_thenReturnToken()`

### 2. 테스트 코드 구조

1. Given (준비)
   ```java
   // 테스트에 필요한 데이터와 객체 준비
   User user = new User("test@example.com", "password");
   ```

2. When (실행)
   ```java
   // 테스트할 메서드 실행
   String result = userService.login(user);
   ```

3. Then (검증)
   ```java
   // 결과 검증
   assertThat(result).isNotNull();
   assertThat(result).hasSize(32);
   ```

### 3. 테스트 코드 작성 예시

```java
class UserServiceTest {
    
    // 사용자 로그인 테스트

    // 유효한 사용자 정보로 로그인 시 토큰을 반환한다
    @Test
    public void givenValidUser_whenLogin_thenReturnToken() {
        // Given
        User user = new User("test@example.com", "password");
        
        // When
        String token = userService.login(user);
        
        // Then
        assertThat(token).isNotNull();
        assertThat(token).hasSize(32);
    }
    
    // 잘못된 비밀번호로 로그인 시 예외가 발생한다
    @Test
    public void givenInvalidPassword_whenLogin_thenThrowException() {
        // Given
        User user = new User("test@example.com", "wrong-password");
        
        // When & Then
        try {
            userService.login(user);
            fail("Expected InvalidPasswordException to be thrown");
        } catch (Exception e) {
            assertThat(e).isInstanceOf(InvalidPasswordException.class);
        }
    }
}
```

### 4. 모킹 사용 예시

```java
import org.junit.runner.RunWith;
import org.mockito.junit.MockitoJUnitRunner;

@RunWith(MockitoJUnitRunner.class)
public class OrderServiceTest {
    
    @Mock
    private PaymentGateway paymentGateway;
    
    @InjectMocks
    private OrderService orderService;
    
    // 결제 성공 시 주문이 완료된다
    @Test
    public void givenSuccessfulPayment_whenProcessOrder_thenOrderCompleted() {
        // Given
        Order order = new Order(1000L);
        when(paymentGateway.process(any())).thenReturn(true);
        
        // When
        OrderResult result = orderService.processOrder(order);
        
        // Then
        assertThat(result.isCompleted()).isTrue();
        verify(paymentGateway).process(any());
    }
}
```

### 5. 테스트 코드 작성 시 주의사항

1. 각 테스트는 독립적으로 실행되어야 함
2. 테스트 데이터는 테스트 메서드 내에서 생성
3. 외부 의존성은 반드시 모킹
4. 테스트 케이스는 한 가지 시나리오만 검증
5. 테스트 실패 시 원인을 쉽게 파악할 수 있도록 명확한 메시지 작성
